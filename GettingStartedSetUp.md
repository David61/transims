[Back to Getting Started](http://code.google.com/p/transims/wiki/GettingStarted)

# Network Preparation #

Network preparation typically involves taking a network from an existing model, and converting it to a TRANSIMS network.  The two major sub-steps are highway network preparation and transit network preparation.

## Highway Network Preparation:  Typical Process ##

**Example Network:** [An example TRANSIMS network](TinyExampleInfo.md) is available to demonstrate many of the steps in this guide. It is recommended that new users download the example network and try running the procedures.

Click [here](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/inputnetwork/TinyNetwork.pdf) to see a very simple network used to illustrate the concepts herein.

### 1. Initial Network Inputs ###
Starting data typically includes a list of [nodes](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/inputnetwork/Input_NodeOriginal.txt) (with UTM coordinates) and a list of [links](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/inputnetwork/Input_LinkOriginal.txt) (with origin / destination node, length, number of lanes in each direction, speed, capacity and other information).  Optional information includes a TRANSIMS [shape](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/inputnetwork/Input_Shape.txt) file and turning restrictions.  If the initial data consists of ESRI shape files, [GISNet](http://transims.googlecode.com/svn/v4/trunk/documentation/quickreference/GISNet%20QR.pdf) may be used to create TRANSIMS files.

### 2. Network Input Corrections and Adjustments ###
Before performing the network conversion, it is best to correct any errors in the input network.  Steps to consider include
  * Removing links and nodes that are not needed for the model.  These may include internal centroid connectors.
  * Adding any new links or nodes that might be needed
  * Correcting the number of lanes and speeds on links
  * Editing links with extremely short lengths.
  * If a signalized divided arterial is represented as two one-way links, converting those links into two-way links and removing the extra nodes. This avoids the issue with two automatically-generated traffic signals extremely close together.
  * Fixing erroneous shape information

In our example network, the two one-way links of Main street were combined, with nodes 16 and 26 being combined, to yield the following [nodes](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/inputnetwork/Input_Node.txt) and [links](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/inputnetwork/Input_Link.txt).

### 3. Generate TRANSIMS Network ###
[TransimsNet (Full)](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/TransimsNet%20v4.0.pdf)  [(Quick Reference - QR)](http://transims.googlecode.com/svn/v4/trunk/documentation/quickreference/TransimsNet%20QR.pdf) is then used to perform the initial network conversion.  Required inputs include **Input\_Node** and **Input\_Link** files.  Optional inputs include **Zone**, **Turn Prohibition** and **Shape** files. [Network Data Tables](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/Network%20Data%20Tables%20v4.0.pdf) contains a list of all of the network tables, along with their fields. Like other TRANSIMS programs, **TransimsNet** uses a [control file](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/control/TransimsNet.ctl).

### 4. Lane Connectivity and Signal Warrant Corrections ###
At this stage a number of other corrections are typically performed:
  * Fixing any issues in the lane\_connectivity file (particularly with multiple turn lanes)
  * Modifying the sign and signal warrants as appropriate.

### 5. Intersection Control Generation ###
[IntControl (Full)](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/IntControl%20v4.0.pdf)   [(QR)](http://transims.googlecode.com/svn/v4/trunk/documentation/quickreference/IntControl%20QR.pdf) [(Sample Control File)](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/control/IntControl.ctl)
is then used to generate the files for the signalized intersections.  Inputs include the Node, Link, Lane\_Connectivity, Pocket\_Lane, Actvity\_Location, Sign\_Warrant, and Signal\_Warrant files that were generated by TransimsNet. [Network Data Tables](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/Network%20Data%20Tables%20v4.0.pdf) contains a list of all of the network tables, along with their fields.

### 6. Subarea Definition ###
If you will be using a subarea network for the microsimulation,  [SubAreaNet (QR)](http://transims.googlecode.com/svn/v4/trunk/documentation/quickreference/SubareaNet%20QR.pdf) [SubAreaNet (Full)](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/SubareaNet%20v4.pdf)  is used to generate the sub-area network.  Required input includes a polygon shape file that defines the subarea.

### 7. GIS Conversion and Inspection ###
Finally, [ArcNet (Full)](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/ArcNet%20v4.0.pdf) [(QR)](http://transims.googlecode.com/svn/v4/trunk/documentation/quickreference/ArcNet%20QR.pdf) to generate shape files from the newly created TRANSIMS network.  These shape files are then loaded into a GIS, and the newly created network is examined for errors.

Other references that may be useful for highway network preparation include
[Progression QR](http://transims.googlecode.com/svn/v4/trunk/documentation/quickreference/Progression%20QR.pdf), [Installation and Testing How-To](http://transims.googlecode.com/svn/v4/trunk/documentation/howto/Step-0_Installation%20and%20Testing%20How-To.pdf), [Installation and Testing User Manual](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/Installation%20and%20Testing.pdf), [Network Data Tables](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/Network%20Data%20Tables%20v4.0.pdf), [Highway Network How-To (New)](http://transims.googlecode.com/svn/v4/trunk/documentation/howto/Step-1_Highway%20Network%20How-To.pdf), [Network Edit How-To](http://transims.googlecode.com/svn/v4/trunk/documentation/howto/Step-3_Network%20Edit%20How-To.pdf)

## Transit Network Preparation:  Typical Process ##

UNDER CONSTRUCTION

How Tos:  [Transit Network How-To](http://transims.googlecode.com/svn/v4/trunk/documentation/howto/Step-2_Transit%20Network%20How-To.pdf)

## Network Editing ##

Network editing is part of the two previously-described processes.

# Trip Table Conversion #

A trip-table based TRANSIMS implementation uses trip table, trip time and activity location files.  The trip table files list the trips by origin zone and destination zone.  The trip time files define how those trips are distributed by time-of-day.  The activity location file associates each zone with one or more activity locations. Steps for preparing TRANSIMS trips from trip tables include the following.

### 1. Modify input trip tables from the four-step model ###
Modify the input trip tables that came from the four-step model. Two modifications that are typically performed include converting the numbers of trips to integers, and (possibly) the removal of intrazonal trips.

Run a script to create TRANSIMS-format trip tables and trip times suitable for input into the TRANSIMS ConvertTrips program

### 2. Make any needed modifications to the activity locations ###
Make any needed modifications to the activity locations. This typically includes the following:
  * If a shape file of zones is available, use [LocationData QR](http://transims.googlecode.com/svn/v4/trunk/documentation/quickreference/LocationData%20QR.pdf)  [LocationData Full](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/LocationDatav4.pdf)                 to assign the activity locations to the proper zones
  * Identify those zones that are still not covered by any activity location, and reassign some activity locations to those zones.  ASU has developed a script for this purpose: [reassign\_zone.py](http://transims.googlecode.com/svn/reassign_zone.py)
  * For external zones and their associated activity locations on one-way (freeway) links, make sure that the inbound link is associated with an origin activity location, and the outbound link with a destination activity location. This is typically done by adding two fields to the Activity\_Location table, ORIGCoef and DESTCoef, whose values are initially set to 1.  If we want to turn an activity location off, either as an origin or destination, the corresponding coefficient field is set to 0. For small networks, this process can be done using a [spreadsheet](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/network/Activity_Location.xls).  The first sheet in this workbook contains the activity locations produced by TransimsNet.  The second contains the locations with ORIGCoef and DESTCoef fields added. Note that locations 11 and 12 were also set to 0, since they were on a freeway overpass.  The [LocationData Full](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/LocationDatav4.pdf) user manual also contains an example of a control file and script that performs this adjustment.

### 3. Run ConvertTrips ###
[Convert Trips (Full)](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/ConvertTrips%20v4.0.pdf) [(QR)](http://transims.googlecode.com/svn/v4/trunk/documentation/quickreference/ConvertTrips%20QR.pdf) [(Sample Control File)](http://transims.googlecode.com/svn/v4/trunk/testcases/tinyexample/control/ConvertTrips.ctl)  program to convert the trip tables and trip time data into Trip, Household, Population and Vehicle files. These files contain the individual trips that are used as input to the TRANSIMS Router.

Other references that may be useful for trip table conversion include

[Trip Table How-To](http://transims.googlecode.com/svn/v4/trunk/documentation/howto/Step-6_Trip%20Table%20Conversion%20How-To.pdf)

SmoothData [QR](http://transims.googlecode.com/svn/v4/trunk/documentation/quickreference/SmoothDataQR.pdf) [Full](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/SmoothDataV4.pdf)

# Activity Generation #

UNDER CONSTRUCTION

How-Tos:  [Activity Generator How-To](http://transims.googlecode.com/svn/v4/trunk/documentation/howto/Step-5_Activity%20Generator%20How-To.pdf), [Population Synthesizer How-To](http://transims.googlecode.com/svn/v4/trunk/documentation/howto/Step-4_Population%20Synthesizer%20How-To.pdf)

User Manuals:  [ActGen](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/ActGen%20v4.0.pdf),  [PopSyn](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/PopSyn%20v4.0.pdf)

[Back to Getting Started](http://code.google.com/p/transims/wiki/GettingStarted)