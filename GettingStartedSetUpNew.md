[Back to Getting Started](http://code.google.com/p/transims/wiki/GettingStarted)



# Network Preparation #

Network preparation typically involves taking a network from an existing model, and converting it to a TRANSIMS network.  The two major sub-steps are highway network preparation and transit network preparation.

**Example Network:** [An example TRANSIMS network](TinyExampleInfo.md) is available to demonstrate many of the steps in this guide. It is recommended that new users download the example network and try running the procedures.

See an image of the example network [here](http://transims.googlecode.com/svn/testcases/tinyexample/inputnetwork/TinyNetwork.pdf).

## Highway Network Preparation: Typical Process ##

### 1. Initial Network Inputs ###
Starting data typically includes a list of **nodes** (with UTM coordinates) and a list of **links** (with origin / destination node, length, number of lanes in each direction, speed, capacity and other information).  Optional information includes a TRANSIMS **shape file** and **turning restrictions**.

If the initial data consists of ESRI shape files, [GISNet](http://transims.googlecode.com/svn/documentation/quickreference/GISNet%20QR.pdf) may be used to create TRANSIMS files.

_**Example network:** TRANSIMS-format **node**, **link**, **shape**, and **turn restriction** files are located in the_inputnetwork_directory._


---


### 2. Network Input Corrections and Adjustments ###
Before performing the network conversion, it is best to correct any errors in the input network.  Steps to consider include
  * Remove links and nodes that are not needed for the model.  These may include internal centroid connectors.
  * Adding any new links or nodes that might be needed
  * Correcting the number of lanes and speeds on links
  * Correction of links with extremely short lengths.
  * If a signalized divided arterial is represented as two one-way links, converting those links into two-way links and removing the extra nodes. This avoids the issue with two automatically-generated traffic signals extremely close together.
  * Fixing erroneous shape information
_**Example Network:** the two one-way links of Main street were combined, with nodes 16 and 26 being combined.  (This change is already implemented in the node and link files)_


---


### 3. Generate TRANSIMS Network ###
[TransimsNet (Full Manual)](http://transims.googlecode.com/svn/documentation/usermanuals/TransimsNet%20v4.0.pdf)  [(Quick Reference - QR)](http://transims.googlecode.com/svn/documentation/quickreference/TransimsNet%20QR.pdf) is then used to perform the initial network conversion.  Required inputs include **Input\_Node** and **Input\_Link** files.  Optional inputs include **Zone**, **Turn\_Prohibition** and **Shape** files. [Network Data Tables](http://transims.googlecode.com/svn/documentation/usermanuals/Network%20Data%20Tables%20v4.0.pdf) contains a list of all of the network tables, along with their fields. Like other TRANSIMS programs, TransimsNet uses a control file.

_**Example Network:** Run_TransimsNet.bat_from the_'batch'_folder.  The control file used for this procedure is_'control\TransimsNet.ctl'_._


---


### 4. Lane Connectivity and Signal Warrant Corrections ###
At this stage a number of other corrections are typically performed:
  * Fixing any issues in the lane connectivity file (particularly with multiple turn lanes)
  * Modifying the sign and signal warrants as appropriate.
_**Example Network:** The_Lane\_Connectivity.txt_and_Signal\_Warrants.txt_files are located in the_'network'_folder._


---


### 5. Intersection Signal Generation ###
[IntControl(Full)](http://transims.googlecode.com/svn/v4/trunk/documentation/usermanuals/IntControl%20v4.0.pdf)  [(QR)](http://transims.googlecode.com/svn/documentation/quickreference/IntControl%20QR.pdf) is then used to generate the files for the signalized intersections.
Inputs include the **Node**, **Link**, **Lane\_Connectivity**, **Pocket\_Lane**, **Actvity\_Location**, **Sign\_Warrant**, and **Signal\_Warrant** files that were generated by TransimsNet.

[Network Data Tables](http://transims.googlecode.com/svn/documentation/usermanuals/Network%20Data%20Tables%20v4.0.pdf) contains a list of all of the network tables, along with their fields.

_**Example Network:** Run_IntControl.bat_from the_'batch'_folder.  The control file_'control\IntControl.ctl'_is used for this procedure._


---


### 6. Subarea Definition ###
If you will be using a subarea network for the microsimulation,  [SubAreaNet (QR)](http://transims.googlecode.com/svn/documentation/quickreference/SubareaNet%20QR.pdf) is used to generate the sub-area network.  Required input includes a polygon shape file that defines the subarea.

_**Example Network:** The example network does not use a subarea._


---


### 7. GIS Conversion and Inspection ###
[ArcNet (Full)](http://transims.googlecode.com/svn/documentation/usermanuals/ArcNet%20v4.0.pdf) [(QR)](http://transims.googlecode.com/svn/documentation/quickreference/ArcNet%20QR.pdf) to generate shape files from the newly created TRANSIMS network.  These shape files are then loaded into a GIS, and the newly created network is examined for errors.

_**Example Network:** Run_ArcNet.bat_from the_'batch'_folder.  The control file_'control\ArcNet.ctl'_is used for this procedure._

Other references that may be useful for highway network preparation include
[Progression QR](http://transims.googlecode.com/svn/documentation/quickreference/Progression%20QR.pdf), [Installation and Testing How-To](http://transims.googlecode.com/svn/trunk/documentation/howto/Step-0_Installation%20and%20Testing%20How-To.pdf), [Installation and Testing User Manual](http://transims.googlecode.com/svn/documentation/usermanuals/Installation%20and%20Testing.pdf), [Network Data Tables](http://transims.googlecode.com/svn/documentation/usermanuals/Network%20Data%20Tables%20v4.0.pdf), [Highway Network How-To (New)](http://transims.googlecode.com/svn/trunk/documentation/howto/Step-1_Highway%20Network%20How-To.pdf), [Network Edit How-To](http://transims.googlecode.com/svn/trunk/documentation/howto/Step-3_Network%20Edit%20How-To.pdf)


---


<a href='Hidden comment: 
==Transit Network Preparation:  Typical Process==

UNDER CONSTRUCTION

How Tos: [http://transims.googlecode.com/svn/trunk/documentation/howto/Step-2_Transit%20Network%20How-To.pdf Transit Network How-To]

==Network Editing==

Network editing is part of the two previously-described processes.

<HR>
'></a>
# Trip Table Conversion #

A trip-table based TRANSIMS implementation uses **trip table**, **trip time**, and **activity location** files.
The **trip table** files list the trips by origin zone and destination zone.  The **trip time** files define how those trips are distributed by time-of-day.  The **activity location** file associates each zone with one or more activity locations. Steps for preparing TRANSIMS trips from trip tables include the following.


---


### 1. Modify input trip tables from the four-step model ###
Two modifications that are typically performed include converting the numbers of trips to integers, and (possibly) the removal of intrazonal trips.

Run a script to create TRANSIMS-format trip tables and trip times suitable for input into the TRANSIMS ConvertTrips program

_**Example Network:** Trip tables are already TRANSIMS-friendly._


---


### 2. Make any needed modifications to the activity locations ###

This typically includes the following:
  * If a shape file of zones is available, use [LocationData](http://transims.googlecode.com/svn/documentation/quickreference/LocationData%20QR.pdf) to assign the activity locations to the proper zones
  * Identify those zones that are still not covered by any activity location, and reassign some activity locations to those zones.
  * For external zones and their associated activity locations on one-way (freeway) links, make sure that the inbound link is associated with an origin activity location, and the outbound link with a destination activity location. This is typically done by adding two fields to the Activity\_Location table, ORIGCoef and DESTCoef, whose values are initially set to 1.  If we want to turn an activity location off, either as an origin or destination, the corresponding coefficient field is set to 0. For small networks, this process can be done using a [spreadsheet](http://transims.googlecode.com/svn/testcases/tinyexample/network/Activity_Location.xls).  The first sheet in this workbook contains the activity locations produced by TransimsNet.  The second contains the locations with ORIGCoef and DESTCoef fields added. Note that locations 11 and 12 were also set to 0, since they were on a freeway overpass.


_**Example Network:** A spreadsheet of activity locations is in the_'NETWORK???'_directory.  The file_'Activity\_Locations\_Weighted.txt'_, previously generated from the spreadsheet, contains a list of demand-weighted activity locations.  This file can be used as-is, or overwritten with any modifications from the spreadsheet._

---


### 3. Run ConvertTrips ###

The [Convert Trips (Full)](http://transims.googlecode.com/svn/documentation/usermanuals/ConvertTrips%20v4.0.pdf) [(QR)](http://transims.googlecode.com/svn/documentation/quickreference/ConvertTrips%20QR.pdf) [(Sample Control File)](http://transims.googlecode.com/svn/testcases/tinyexample/control/ConvertTrips.ctl) program converts the trip tables and trip time data into **Trip**, **Household**, **Population**, and **Vehicle** files. These files contain the individual trips that are used as input to the TRANSIMS Router.

Other references that may be useful for trip table conversion include

[Trip Table How-To](http://transims.googlecode.com/svn/trunk/documentation/howto/Step-6_Trip%20Table%20Conversion%20How-To.pdf)

<a href='Hidden comment: 
!SmoothData
'></a>

_**Example Network:** Run_'batch\ConvertTrips.bat'_.  The control file used for this is_'control\ConvertTrips.ctl'.


---


# Activity Generation #

UNDER CONSTRUCTION

How-Tos:  [Activity Generator How-To](http://transims.googlecode.com/svn/trunk/documentation/howto/Step-5_Activity%20Generator%20How-To.pdf), [Population Synthesizer How-To](http://transims.googlecode.com/svn/trunk/documentation/howto/Step-4_Population%20Synthesizer%20How-To.pdf)

User Manuals:  [ActGen](http://transims.googlecode.com/svn/documentation/usermanuals/ActGen%20v4.0.pdf),  [PopSyn](http://transims.googlecode.com/svn/documentation/usermanuals/PopSyn%20v4.0.pdf)

[Back to Getting Started](http://code.google.com/p/transims/wiki/GettingStarted)